## 类和继承

---

### 类与原型

设想一下，现在我们是一家汽车经销商，拥有随时待命的工厂。每当我们经手一辆新的汽车，我们就可以写出一个汽车对象，拥有它自己的属性。

```javascript
let car = {
    brand: "Honda Civic",
    color: "blue"
};
```

如果只有寥寥几辆的汽车需求，那么这种办法尚可接受；但是，如果汽车订单多了起来，我们恐怕不能像这样一辆辆手工生产。JavaScript 赋予了我们一种机器，可以根据设计图纸批量生产出汽车——想要多少就有多少！

我们知道，每辆汽车都属于“汽车”这类产品，同时所有的汽车都会拥有自己的 `brand` `color` 属性，我们可以制定好汽车产品的原型，每次生产时只需要说明它的品牌与颜色。现在是时候掀开这台神奇机器的面纱了！

```javascript
class Car {};
```

嘿，等等，这是什么！`class` 是做什么的？

其实， `class` 是一个新的关键字，用于表示“一类”什么东西，用 JavaScript 的话说，是*定义了一个类*。 `Car` 就是这个类（“这类东西”）的名称，一般使用大写字母开头，这里我们定义了 `Car` 这个类以表示汽车。其后的大括号将会包含生产汽车所需要的一些工具。

有了 `Car` 类，我们就可以开动机器快速生产出一辆新的汽车。

```javascript
let car = new Car();
```

这个写法是不是有些眼熟？我们在第三章中接触过。在第三章中，我们了解到： `new` 关键字用于*生成一个构造器的实例*，在这里 `Car` 就承担了构造器的作用，我们写下 `new Car()` ，也就相当于拥有了一辆新的汽车。

但是，我们会发现这个新的汽车并没有 `brand` 和 `color` 属性。

```javascript
alert(car.brand); // undefined
alert(car.color); // undefined
```

所以，仅仅写出 `class Car` 是不够的，我们需要画好设计草图，说明这类汽车将会拥有什么属性。我们可以在 `Car` 类中写出一个名为 `constructor` 的*方法*。

```javascript
class Car {
    constructor (brand, color) {}
};
```

这个 `constructor` 又是做什么的呢？它就是我们将来每次生产汽车时所遵循的设计草图。它是一个特殊的方法，称为*构造函数*。就像这个名字所提示的那样，它的作用是构造一个对象。在构造一个汽车对象时我们需要做什么呢？当然是确定它的牌子与颜色。

```javascript
class Car {
    constructor (brand, color) {
        this.brand = brand;
        this.color = color;
    }
};
```

现在，我们再来生成新的汽车对象。

```javascript
let car = new Car("Honda Civic", "blue");
alert(car.brand); // "Honda Civic"
alert(car.color); // "blue"
```

现在它是一辆拥有自己的属性的汽车了！我们只需要将它的品牌和颜色值当做构造函数的参数，多么容易！

现在回来看 `Car` 类的定义。它的构造函数 `constructor` 接受两个参数 `brand` 和 `color`，分别对应品牌和颜色。其后两行代码的含义是：将汽车的 `brand` 和 `color` 属性设置为参数 `brand` 和 `color` 的值。

在类的定义中，**`this` 关键字表示将会构造的对象本身，它的属性表示对象将会拥有的属性。**

也就是说，当我们写下 `this.xxx = yyy` 时，我们就说明了将来生成的对象的 `xxx` 属性的值会是 `yyy`。我们还记得第三章中引入的概念——“实例”和“实例化”——吗？现在我们可以阐述一下类所发挥的作用了。

首先，`Car` 是一个类，它拥有一个构造函数。当我们像这样：`new Car("any", "any")` 实例化一个类时，我们会接受一些参数，实际上调用了类的构造函数，并在构造函数中完成了完成了构造一个对象所需做的事情。

在 JavaScript 中，一个类是一种特殊的函数。但是它不能像通常的函数那样直接调用。

```javascript
new Car("Unknown", "black"); // OK
Car("Unknown", "black");     // TypeError: Class constructor Car cannot be invoked without 'new'
```

除了 `constructor` 之外，类还可以拥有其它的方法，它们的形式像在对象字面量中一样，不过应该省略逗号。

```javascript
class Car {
    constructor (brand, color) {
        this.brand = brand;
        this.color = color;
    }
    toString () {
        return `This car's brand is ${this.brand} and its color is ${this.color}.`;
    }
}
let car = new Car("Byd Auto", "silver");
alert(car.toString()); // "This car's brand is Byd Auto and its color is silver."
```

所有的类都具有一个 `prototype` 属性，它是所有实例的*原型*，用于规定类的定义中所包含的东西。在一个类中， `this` 关键字实际上指这个原型。我们可以手动为原型的属性赋值，但是请注意：**我们在 `prototype` 属性上手动定义的方法，是无法访问 `this` 的。**也就是说，如果我们要为类添加构造函数或其他方法，必须在类的定义里面。

```javascript
class Car {};
Car.prototype.model = "Unkonw"; // 默认
Car.prototype.color = "black";  // 默认

// 这个构造函数无法对 this 进行操作！
Car.prototype.constructor = () => {
    this.model = "Saic Motor";
    this.color = "white";
}
let car = new Car()
alert(car.model); // "Unknown"
alert(car.color); // "black"
```





### 面向对象

在前面章节的示例中，一个程序通常由几个函数组成，一个函数负责一项功能，几个函数组合起来完成程序的任务，最后写几个语句来调用函数。函数在对象中，就成了方法——它看起来只是把函数的位置转移到了对象中而已。

但是现在，我们可以将“要做什么事情”交给对象自己来管理，而一个完整的程序，实际上就是对不同对象的操作。我们可以使用对象和类作为程序组织的基本结构，程序所做的事情由不同的对象进行处理，而不是像先前那样写出一堆零散的函数和流程。这种程序设计的思想称为*面向对象编程*。

> 面向对象程序设计是一种程序开发的抽象方针。它可能包含数据、属性、代码与方法，对象则指的是类的实例。它将对象作为程序的基本单元，将程序和数据封装其中，以提高软件的重用性、灵活性和扩展性，对象里的程序可以访问及经常修改对象相关联的数据。在面向对象程序编程里，计算机程序会被设计成彼此相关的对象。
>
> ——Wikipedia

Wikipedia 描述了面向对象程序设计的基本概念，更专业的叫法是“面向对象范式”。从面向对象的角度来看，应用程序是一组彼此通信的“对象”。具有一些相似特征的对象可以用相同方式构造出来，承担这一任务的就是类。对象和类一般都是基于现实世界中的事物，例如仓库中的产品或是一个自然人。对象包含数据，并根据其数据执行一些操作，而一个类则是用于构造对象的模板。对象之间用接口来互通有无，将接口与实现分离。这是一个好主意，它通常称为*封装*。

听起来是否有些熟悉——我们在第五章的开头部分就阐述过将操作的细节封装在不同函数的概念。只不过，面向对象的思考方式更进一步：它使函数抱团合体，使数据得以妥善保存与操作，使应用程序成为一个有机的整体。

JavaScript 中的面向对象方式是*基于原型*的，所有的对象都由某一个类构造而来，每个类都具有一个 `prototype` 属性，它本身是一个对象的模板，当我们实例化一个对象时，就会根据类的 `prototype` 确定对象会包含什么内容，同时执行构造函数，完成实例化时需要做的一些工作，类的 `prototype` 属性就是实例对象的“原型”。在 JavaScript 中，我们可以通过包含已有的原型，来设计新的原型，这个过程称为*继承*，我们将在下一小节中了解到。

所有对象的都有一个共同的祖先，它是一个类，称为 `Object`，意思就是“对象”。它的原型包括了任何对象都应该具有的一些信息。是不是有些眼熟？我们已经在第三章接触对象时见到了它。我们还记得，当我们实例化（`new`）`Object` 时，我们便会得到一个空对象。`Object` 类和原型具有许多细节，我们将在后面的章节中详细了解。

面向对象是一种思想，它为我们指导了编写出具有专业性的代码的方式，它的基本形式是将一切数据看做一个个互相关联又彼此独立的对象，将程序的运作转化为对象之间的交流，它的重要特点是**隐藏对象的状态**，同时使我们的注意力放在如何操作对象，而非零散的“流水账式”的编程。在这个过程中，类的作用是**为我们定制我们需要的对象**。





### 继承

假设我们就像楚辞中的司命神一样掌管人类的寿夭轮回、生息繁衍，用一个类来概述世间所有人类的本质。

```javascript
class Human
{
    constructor (name, age) {
        this.name = name;
        this.age  = age;
    }    
}
    
```



我们知道下述事实：

```
人类的概念包括成年人和儿童。
```



在面向对象相关的技术中，“抽象基类”这个术语常用来描述一个





### 原型链







