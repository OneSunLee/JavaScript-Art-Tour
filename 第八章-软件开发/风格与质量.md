## 见微知著·风格与质量

---

### 编程风格

什么是*风格*？维克多·雨果说：“风格是不断被称为表面有某个主题特征的东西。”本章所讨论的风格不是指流行风尚，但对于好的程序员而言就像模特的穿衣搭配一样重要。风格经常被用来作为*质量*的度量。风格在实践中悄悄产生，遵从它的人便会从它独特的视角和洞察力来审视某个主题。一种特定的风格能够将我们所做的事情变得更好，甚至扩大我们的回报。画家莫奈的风格是“根据感受而非细节来画画”，从那以后就有了印象派。印象派作为一种风格，从一个人身上产生，被一群人所认同，被其他人所知晓所吸引，成为影响深远的艺术运动。而在思想与政治领域，一种意识形态的风格能够影响我们对社会中一切客观实体的看法。风格是新的思想的直观特征，风格同时为新的思想的诞生和传播带来契机。

风格必须是*可重复*的，可以转变成一系列可以遵循的规则或步骤的组合，并得到别人的认可，这就像算法一样。如果风格可以衡量某些产品的质量，同时可以重复使用，那么这种风格就可以教给别人。作家写作的风格恰恰是了然于心的规则的体现。《风格元素》一书中提及了二十二条各类与风格相关的规则，这样读者们就可以拥有一个框架来评估自己的工作。有时规则看起来会限制诸多，并令人不爽，但我们也要知道，风格需要的不仅仅是一时兴起的激情，还需要有画出边界并走出直路的能力。风格就像是一块永久磁铁，吸引着一些人，又排斥另外一些人。

风格在程序员身上的体现，称为*编程风格*，它包含一系列特定的、经过学习与实践的思考方式和编程习惯。好的编程风格可以带来赏心悦目、清晰易读的代码，这时编程风格服务的是程序员自己和其他人，有时是为了让计算机更高效地接受人们的命令，更不容易出错。编程风格体现在语法的使用上和技术上，下面我们将阐述在好的编程风格中程序员应当注意的品质。

（1）一致性

一个项目中的所有代码都应当遵循某个风格所界定的规则，以保持代码的一致性，这种约束本身就是风格在*一致性*上的体现。一致性能减少代码带给读者切换理解方式的疲劳，同时能让程序员更清晰地专注于代码所表达的意图。一致性关注代码看起来怎样，包括*命名约定*，*缩进方式*和*方法签名*等，同时关注代码编写的细节，例如函数是否总返回一个值，`switch` 语句是否总有默认条件，`try...catch` 语句是否总会处理捕获的异常等。

（2）表达能力

代码本质上是一种符号语言，其中隐含了可变性和抽象性。因此，我们必须找到一种方法，使代码有意义并且和读者相关。相关性可以通过精确的变量和方法命名来实现。在查看一个方法或变量的时候，读者应该通过阅读代码清晰了解代码所做的事情和职责。如果一个函数必须通过大段的注释才能让读者理解它做了什么，那么这个函数往往在表达能力上有所欠缺。

（3）简洁

好的编程过程就像好的写作过程一样，是对目的明确的表示，而不仅仅为了紧凑或展示黑魔法。简洁的目的是减少代码的复杂度，而非减少代码的灵活与可用范围。

（4）约束性

风格不应该压倒主题，否则风格就会成为主题本身，成为一道由于过分调味而味色尽毁的佳肴。在编程中，小聪明容易铸就大错误，我们必须要根据固有准则限制自己，不要用语言的缺陷与奇技淫巧来取悦自己和他人，最终留下难以理解和维护的代码。

风格指南为我们提供行动的准则，而让准则真正地成为我们的代码风格，就像行走、说话、书写的习惯一样，需要大量的实践。我们必须通过在实践中用行动来思考，从而真正理解风格本身。接下来我们将阅读一份风格指南，它是 JavaScript 界的诸多前辈和专业人士在属于他们的实践与斟酌中产生的。它们基于一系列已有的良好共识，而不是某一个人的创意作品。这份风格指南分为两部分：**视觉清晰度**和**代码效率**。





### 视觉清晰度

根据视觉清晰度的要求，我们应注意以下准则：

- **书写清晰并且表达力强。**当我们思考代码中的视觉清晰度时，在头脑中保持这个规则是很重要的。当定义变量、方法或组织代码结构时，请牢记：我们的代码是给像我们和朋友们这样的人类阅读的，而不是给计算机。
- **遵从现有的惯例。**如果我们在一个团队中工作或是为一家公司编程，我们不是在为自己编写。因此，我们应该让我们的风格和现有的习惯、生态系统相吻合，当然这一切都建立在不牺牲实际质量的大前提下。
- **只使用一种语言**。我们绝不要将 JavaScript 当成其他语言的拼接工具或传送带，因此我们要避免把 HTML 和 CSS 等的代码直接内嵌在 JavaScript 中的习惯。关注点分离是编写清晰的代码的重要基础。
- **使用统一和适度的代码行宽。**我们要力争在整个项目的所有代码中保持一致的代码行长度。长代码行会使眼睛疲劳，从而降低我们的理解度。长代码还会导致读者不得不滑动水平滚动条。一个行业常用的标准是每行不超过 80 个字符。

理解程序的代码，就像把计算机繁复的工作搬到人脑中进行，这个过程需要我们的持续关注，任何分心都可能使我们的思绪无法沿着代码的逻辑前进。不正确或不一致的代码格式，就像是耳边的噪音或眼前的频闪。这一节提供关于代码格式的指南，它们是避免代码难以卒读的根本要素。

（1）命名约定

JavaScript 是一种有标点符号、数字和字母的简洁语言，为了让代码能使人脑理解其意义，我们可以对变量、函数和属性进行有意义的命名。当选择一个名字的时候，它应当能描述自己的角色和职责。使用模糊或可能产生误解的名字，如 `something` 、 `rice` 或 `a1` 等，就像是告诉读者你要自己弄明白，但读者往往不会弄明白，时间一长我们甚至也会忘记我们的标识符的用意。

如果我们需要用一个词或词组描述某个概念，良好的习惯是使用其英文名称来命名。如果我们对英文不是那么熟练，我们宁可专门去查阅词典，也绝不要使用汉语拼音，它非常潦草和令人生厌。

请为变量和函数选择有意义的、清晰明了的以及准确描述的名称。我们是为人类编写，而不是为了计算机。

```javascript
// 不好
let a = 1;
let aa = (aaa) => "" + aaa;

// 好
let count = 1;
let toString = (num) => "" + num;
```



---

Story：

也不要用“中式英语”或直接从中文硬翻译的表达。曾有人在一个项目中，将需要存储长度的地方，由于单位是“米”，都用 `rice` 来表示。此外，还有人将“小括号 ”（parentheses）、“中括号”（brackets）、“大括号”（braces）分别用 `small`、`middle`、`large` 来代替，诸如此类。事实上这类命名与其含义没有任何关联。一些国内的教材也热衷于使用拼音甚至毫无可读性的拼音缩写来命名标识符，进而对学习者的命名习惯产生负面影响。以上行为都是不负责任的体现。

---



（2）常量

常量应该使用 `const` 关键字来声明。任何不应该被重定义的值，包括节点对象、工具函数等，都应该尽量声明为常量。当 `const` 关键字不能使用时，常量应该属于一个命名空间或对象，这样有助于区分标识符并防止命名冲突。如果一个值是基本值，请用大写字母来命名以达到明显的提示作用，并用下划线代替空格。

```javascript
// 不好
let element = document.getElementById("fixed");
const ageOfTeacher = 40;

// 好
const element = document.getElementById("fixed");
const AGE_OF_TEACHER = 40；
object.group.AGE_OF_TEACHER = 40；
Math.PI = 3.1415926535;
```

（3）额外的命名约定

命名约定应该给变量或对象带来额外的含义，来达到暗示其功能和语义的目的。例如，JavaScript 中的类本质上是不能直接调用的函数，为了与普通函数区分，类名应该使用大写字母开头。下面的命名约定常见于 JavaScript 社区，它被称为*匈牙利命名法*（Hungarian Law）。

变量名应该使用驼峰拼写法（CamelCase）：

`theVariableName`

类应该使用帕斯卡拼写法（PascalCase），其名称来自 Pascal 语言：

`TheFirstClass`

函数也应该使用驼峰拼写法：

`toEat(cake)`

匈牙利命名法不是必须的，但它确实是 JavaScript 的默认命名方式。除此以外，命名约定也可用于表达某个对象或函数来自特定的库或框架。

```javascript
// 一个通过 jQuery 库取得的元素对象
let $listItem = $("li:first");

// Angular 框架用美金符号前缀来表达其使用的变量
$scope, $watch, $filter //, etc.
```







### 代码效率







### 质量与分析







### 复杂度







